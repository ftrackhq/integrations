# Create public release on tag push, preserves previous releases.
# Re-tags "<package>/stable" to point on tag

name: CI-TAG

on: #push
  push:
    tags:
      - '*' # Enable CI - trigger on all tags

jobs:

  # Set the environment variables for the rest of release workflow
  set-variables:
    runs-on: ubuntu-latest
    outputs:
      package: ${{ env.PACKAGE }}
      version: ${{ env.VERSION }}
      tag: ${{ env.TAG }}
    steps:
      - name: set environments on full release
        shell: bash
        run: |
          echo "PACKAGE=$(echo ${{ github.ref }} | cut -d/ -f 3-3)" >> $GITHUB_ENV
          echo "VERSION=$(echo ${{ github.ref }} | cut -d/ -f 4-4)" >> $GITHUB_ENV
          echo "TAG=$(echo ${{ github.ref }} | cut -d/ -f 3-4)" >> $GITHUB_ENV
      - name: debug
        shell: bash
        run: |
          echo 'PACKAGE: ${{env.PACKAGE}}'
          echo 'VERSION: ${{env.VERSION}}'
          echo 'TAG: ${{env.TAG}}'
